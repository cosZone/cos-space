---
import Divider from '@/components/ui/divider';
import HomeSider from '@components/layout/HomeSider.astro';
import PostList from '@components/post/PostList.astro';
import WeeklyCover from '@components/ui/cover/WeeklyCover.astro';
import { CONTENT_PADDING } from '@constants/layout';
import { siteConfig } from '@constants/site-config';
import Layout from '@layouts/Layout.astro';
import TwoColumnLayout from '@layouts/TwoColumnLayout.astro';
import { getPostsByCategory } from '@lib/content';

// 获取周刊分类的所有文章
const featuredSeriesConfig = siteConfig.featuredSeries;
const weeklyPosts = featuredSeriesConfig?.categoryName ? await getPostsByCategory(featuredSeriesConfig.categoryName) : [];

const pageTitle = featuredSeriesConfig?.fullName ?? featuredSeriesConfig?.label ?? '周刊';
---

<Layout title={`${pageTitle} | ${siteConfig.title}`} description={featuredSeriesConfig?.description?.slice(0, 160)}>
  <TwoColumnLayout>
    <WeeklyCover slot="cover" />
    <HomeSider slot="sider" />
    <div class={`shadow-box bg-gradient-start mx-0 flex w-full flex-col ${CONTENT_PADDING.standard}`}>
      <h2 class="shoka-decoration-circle group relative h-19 px-6 py-5 text-2xl/9 font-bold md:text-xl/9">
        <a href="/" class="dashed-border text-muted-foreground group-hover:border-blue group-hover:text-blue border-b">首页</a>
        <span class="text-muted-foreground text-lg md:text-base"> / </span>
        共 {weeklyPosts.length} 篇文章
      </h2>
      <PostList posts={weeklyPosts} showPaginator={false} isSimple={true} />
    </div>
  </TwoColumnLayout>
</Layout>
