---
import { Button } from '@components/ui/button';
import type { Page } from 'astro';
import { FaChevronLeft, FaChevronRight } from 'react-icons/fa';
import type { BlogPost } from 'types/blog';

interface Props {
  page: Page<BlogPost>;
  baseUrl?: string; // 分页基础路径，默认为 '/posts'
  isHomePage?: boolean; // 是否是首页
}

const { page, baseUrl = '/posts', isHomePage = false } = Astro.props;

// 生成页面链接的辅助函数
const getPageUrl = (pageNum: number) => {
  // 如果是首页模式，第1页指向 '/'，其他页指向 '/posts/x'
  if (isHomePage) {
    return pageNum === 1 ? '/' : `${baseUrl}/${pageNum}`;
  }
  // 普通模式：第1页是 baseUrl，其他页是 baseUrl/2 等
  return pageNum === 1 ? baseUrl : `${baseUrl}/${pageNum}`;
};
---

<div class="flex-center gap-1 font-bold">
  <a href={page.url.prev} aria-label="Previous page" aria-label="Previous page">
    <Button variant="ghost" disabled={page.currentPage === page.start + 1}>
      <FaChevronLeft />
    </Button>
  </a>

  {
    page.currentPage !== 1 && page.currentPage - 1 !== 1 && (
      <a href={getPageUrl(1)}>
        <Button variant="ghost">1</Button>
      </a>
    )
  }
  {page.currentPage > 2 && <span class="mx-1">...</span>}
  {
    page.currentPage !== 1 && (
      <a href={getPageUrl(page.currentPage - 1)}>
        <Button variant="ghost">{page.currentPage - 1}</Button>
      </a>
    )
  }

  <Button variant="ghost" disabled className="text-primary disabled:opacity-100">
    {page.currentPage}
  </Button>

  {
    page.currentPage !== page.lastPage && (
      <a href={getPageUrl(page.currentPage + 1)}>
        <Button variant="ghost">{page.currentPage + 1}</Button>
      </a>
    )
  }
  {page.currentPage < page.lastPage - 2 && <span class="mx-1">...</span>}
  {
    page.currentPage !== page.lastPage && page.currentPage + 1 !== page.lastPage && (
      <a href={getPageUrl(page.lastPage)}>
        <Button variant="ghost">{page.lastPage}</Button>
      </a>
    )
  }
  <a href={page.url.next ?? ''} aria-label="Next page">
    <Button variant="ghost" disabled={page.currentPage === page.lastPage}>
      <FaChevronRight />
    </Button>
  </a>
</div>
